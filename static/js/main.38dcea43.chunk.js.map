{"version":3,"sources":["apps/ProfileApp.js","apps/MailApp.js","Home.js","Auth.js","Router.js","index.js","assets/anon.png","assets/gray_near_logo.svg","assets/encryptionOn.png","assets/encryptionOff.png","near/config.js"],"names":["ProfileApp","props","keys","state","reduce","acc","key","chainValues","initialized","this","setState","Promise","all","map","app","get","values","i","Object","assign","prevProps","init","value","console","log","length","forEach","set","then","f","sourceImage","Image","reader","FileReader","readAsDataURL","onload","canvas","document","createElement","aspect","naturalWidth","naturalHeight","width","Math","round","max","height","ctx","getContext","imageSmoothingQuality","fillStyle","fillRect","drawImage","options","toDataURL","sort","a","b","handleChange","event","src","target","result","e","className","onClick","logOut","accountId","profileUrl","displayName","bio","defaultProfileUrl","anon","htmlFor","placeholder","id","disabled","onChange","type","onFilesChange","onError","onFilesError","multiple","accepts","minFileSize","clickable","save","React","Component","MailApp","receiverId","subject","content","sending","numLetters","unread","expandedId","profileFound","profileLoading","keyLoading","theirPublicKey64","inbox","textarea","createRef","keyCache","letter","messageId","undefined","filter","push","time","read","onNewMail","version","num","allMigrations","encrypted","resolve","catch","storeEncryptionPublicKey","migrateFrom","modifyLetter","fetchMessages","getFrom","encryptionKey","profile","fetchKey","stateChange","toLowerCase","replace","fetchTimeoutId","clearTimeout","pullMessage","message","setTimeout","inner","JSON","parse","isEncrypted","fromAppId","appId","decryptMessage","sender","decryptedMessage","trunc","newNumLetters","warn","error","stringify","encryptMessage","sendMessage","startsWith","Date","toLocaleDateString","join","split","s","current","focus","setSelectionRange","scrollLeft","scrollTop","remove","encryptionEnabled","displayEncryptionIcon","encryptionAlt","encryptionIcon","encryptionOn","encryptionOff","title","alt","onFetch","updateKey","expanded","deleteLetter","replyTo","selectLetter","role","aria-label","receiverClass","ref","rows","sendMail","Letter","t","toLocaleString","d","getDate","hour","getHours","minute","getMinutes","toString","padStart","daytime","timeFormat","Home","requestSignOut","wallet","signOut","signedOutFlow","isSignedIn","window","location","search","includes","origin","pathname","login","apps","logs","loading","signedInFlow","bind","requestSignIn","checkSignIn","initOpenWebApp","nearlib","walletAccount","concat","getAccountId","near","connection","account","code_hash","fetch","data","arrayBuffer","buf","deployContract","Uint8Array","viewMethods","changeMethods","contract","new","masterContract","graph","mail","OpenWebApp","nearConfig","ready","getAccessPublicKey","pk","args","public_key","serialize","SCHEMA","app_id","add_app_key","onKeyAdded","forceRenderTabPanel","nearlogo","Auth","queryString","pub_key","authorized","new_app_id","new_pub_key","res","Router","basename","process","hashType","exact","path","component","getConfig","deps","keyStore","BrowserLocalStorageKeyStore","nearInitPromise","InitContract","ReactDOM","render","getElementById","module","exports","env","networkId","nodeUrl","contractName","walletUrl","keyPath","HOME","masterAccount","Error","Cookies","require","cookieConfig","getJSON","nearPages"],"mappings":"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","file":"static/js/main.38dcea43.chunk.js","sourcesContent":["import React from \"react\";\nimport anon from \"../assets/anon.png\";\nimport Files from \"react-files\";\nimport { Profile } from \"react-near-openweb\";\n\nconst uploadResizeWidth = 96;\nconst uploadResizeHeight = 96;\n\nexport class ProfileApp extends React.Component {\n  constructor(props) {\n    super(props);\n    const keys = [\n      \"displayName\",\n      \"profileUrl\",\n      \"bio\",\n    ];\n    this.state = keys.reduce((acc, key) => {\n      acc[key] = \"\";\n      acc.chainValues[key] = null;\n      return acc;\n    }, {\n      keys,\n      chainValues: {},\n      initialized: false,\n    });\n  }\n\n  async init() {\n    this.setState({\n      initialized: true,\n    });\n    const values = await Promise.all(this.state.keys.map((key) => this.props.app.get(key)));\n    const chainValues = this.state.keys.reduce((acc, key, i) => {\n      acc[key] = values[i] || \"\";\n      return acc;\n    }, {});\n    this.setState(Object.assign({chainValues}, chainValues));\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.app && !this.state.initialized) {\n      this.init();\n    }\n  }\n\n  handleChange(key, value) {\n    console.log(value.length);\n    this.setState({\n      [key]: value,\n    });\n  }\n\n  async save() {\n    console.log(\"Saving\");\n    const chainValues = Object.assign({}, this.state.chainValues);\n    this.state.keys.forEach(key => {\n      if (this.state.chainValues[key] !== this.state[key]) {\n        chainValues[key] = this.state[key];\n        this.props.app.set(key, this.state[key]).then(() => {\n          console.log(\"Updated key `\" + key + \"` to value `\" + this.state[key] + '`');\n        });\n      }\n    });\n    this.setState({\n      chainValues\n    })\n  }\n\n  async onFilesChange(f) {\n    let sourceImage = new Image();\n    let reader = new FileReader();\n\n    reader.readAsDataURL(f[0]);\n\n    sourceImage.onload = () => {\n      // Create a canvas with the desired dimensions\n      let canvas = document.createElement(\"canvas\");\n      const aspect = sourceImage.naturalWidth / sourceImage.naturalHeight;\n      const width = Math.round(uploadResizeWidth * Math.max(1, aspect));\n      const height = Math.round(uploadResizeHeight * Math.max(1, 1 / aspect));\n      canvas.width = uploadResizeWidth;\n      canvas.height = uploadResizeHeight;\n      const ctx = canvas.getContext(\"2d\");\n\n      // Scale and draw the source image to the canvas\n      ctx.imageSmoothingQuality = \"high\";\n      ctx.fillStyle = \"#fff\";\n      ctx.fillRect(0, 0, uploadResizeWidth, uploadResizeHeight);\n      ctx.drawImage(sourceImage, (uploadResizeWidth - width) / 2, (uploadResizeHeight - height) / 2, width, height);\n\n      // Convert the canvas to a data URL in PNG format\n      const options = [\n        canvas.toDataURL('image/jpeg', 0.92),\n        canvas.toDataURL('image/webp', 0.92),\n        canvas.toDataURL('image/png')\n      ];\n      options.sort((a, b) => a.length - b.length);\n\n      this.handleChange('profileUrl', options[0]);\n    }\n\n    reader.onload = function(event) {\n      sourceImage.src = event.target.result;\n    };\n  }\n\n  async onFilesError(e, f) {\n    console.log(e, f);\n  }\n\n  render() {\n    return (\n      <div>\n        <div>\n          <button className=\"float-right\" onClick={this.props.logOut}>Log out</button>\n          <Profile\n            accountId={this.props.app && this.props.app.accountId}\n            profileUrl={this.state.profileUrl}\n            displayName={this.state.displayName}\n            bio={this.state.bio}\n            defaultProfileUrl={anon}\n          />\n        </div>\n        <hr/>\n        <div>\n          <div className=\"form-group\">\n            <label htmlFor=\"displayName\">Display Name</label>\n            <input placeholder=\"The REAL Satoshi\" id=\"displayName\" className=\"form-control\" disabled={!this.props.app} value={this.state.displayName} onChange={(e) => this.handleChange('displayName', e.target.value)} />\n          </div>\n          <label htmlFor=\"profileUrl\">Profile URL</label>\n          <div className=\"input-group\">\n            <input placeholder={\"https://metanear.com\" + anon} id=\"profileUrl\" className=\"form-control\" disabled={!this.props.app} value={this.state.profileUrl}\n                   onChange={(e) => this.handleChange('profileUrl', e.target.value)}/>\n            <div className=\"input-group-append\">\n              <Files\n                type=\"button\"\n                className='btn btn-outline-primary'\n                onChange={(f) => this.onFilesChange(f)}\n                onError={(e, f) => this.onFilesError(e, f)}\n                multiple={false}\n                accepts={['image/*']}\n                minFileSize={1}\n                clickable\n              >\n                Click to upload\n              </Files>\n            </div>\n\n          </div>\n          <div className=\"form-group\">\n            <label htmlFor=\"bio\">Bio</label>\n            <textarea placeholder=\"I'm working on Bitcoin, so bankers can go home.\" id=\"bio\" className=\"form-control\" disabled={!this.props.app} value={this.state.bio} onChange={(e) => this.handleChange('bio', e.target.value)} />\n          </div>\n          <div className=\"form-group\">\n            <button onClick={() => this.save()}>Save changes</button>\n          </div>\n        </div>\n      </div>\n    )\n  }\n}\n","import React from \"react\";\nimport anon from \"../assets/anon.png\";\nimport encryptionOn from \"../assets/encryptionOn.png\";\nimport encryptionOff from \"../assets/encryptionOff.png\";\nimport { encryptionKey } from \"near-openweb-js\";\nimport { Profile } from \"react-near-openweb\";\n\nconst RE = \"Re: \";\nconst currentVersion = 2;\n\nexport class MailApp extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      initialized: false,\n      receiverId: \"\",\n      subject: \"\",\n      content: \"\",\n      sending: false,\n      numLetters: 0,\n      unread: 0,\n      expandedId: -1,\n      profileFound: false,\n      profileLoading: false,\n      keyLoading: false,\n      theirPublicKey64: null,\n      inbox: [],\n    }\n    this.textarea = React.createRef();\n    this.keyCache = {};\n  }\n\n  modifyLetter(letter, messageId) {\n    if (messageId === undefined) {\n      if (!letter) {\n        return;\n      }\n      messageId = letter.messageId;\n    }\n    const inbox = this.state.inbox.filter((a) => a.messageId !== messageId);\n    if (letter) {\n      inbox.push(letter);\n    }\n    inbox.sort((a, b) => b.time - a.time);\n    const unread = inbox.reduce((acc, letter) => acc + (letter.read ? 0: 1), 0);\n    this.setState({\n      inbox,\n      unread,\n    });\n    this.props.onNewMail(unread);\n  }\n\n  async migrateFrom(version) {\n    if (version === 0) {\n      console.log(\"Migrating from version #0\");\n      let num = 0;\n      try {\n        num = await this.props.app.get('numLetters');\n      } catch (e) {\n        // whatever. Probably died during migration.\n      }\n      const allMigrations = [];\n      for (let i = 0; i < num; ++i) {\n        allMigrations.push(this.props.app.get('letter_' + i).then((letter) => {\n          if (letter) {\n            return this.props.app.set('letter_' + i, letter, {encrypted: true}).then(() => {\n              console.log(\"Migrated letter #\" + i);\n            })\n          }\n          return Promise.resolve();\n        }).catch((e) => console.log(\"Can't migrate letter #\", i, e)));\n      }\n      await Promise.all(allMigrations);\n      await this.props.app.set('numLetters', num, { encrypted: true });\n      version++;\n    }\n    if (version === 1) {\n      console.log(\"Migrating from version #1\");\n      await this.props.app.storeEncryptionPublicKey();\n      version++;\n    }\n    await this.props.app.set('version', version, { encrypted: true });\n  }\n\n  async init() {\n    this.setState({\n      initialized: true,\n    });\n    const version = await this.props.app.get('version', { encrypted: true }) || 0;\n    if (version < currentVersion) {\n      await this.migrateFrom(version);\n    }\n    const num = await this.props.app.get('numLetters', { encrypted: true }) || 0;\n    this.setState({\n      numLetters: num,\n    });\n    for (let i = Math.max(0, num - 10); i < num; ++i) {\n      this.props.app.get('letter_' + i, {encrypted: true}).then((letter) => this.modifyLetter(letter));\n    }\n    this.fetchMessages();\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.app && !this.state.initialized) {\n      this.init();\n    }\n  }\n\n  async fetchKey(accountId) {\n    if (accountId in this.keyCache) {\n      return await this.keyCache[accountId];\n    } else {\n      console.log(\"Fetching key for \" + accountId);\n      this.keyCache[accountId] = this.props.app.getFrom(accountId, encryptionKey).catch((e) => false);\n      return await this.keyCache[accountId];\n    }\n  }\n\n  updateKey(profile) {\n    if (!this.props.app) {\n      return;\n    }\n    this.setState({\n      profileLoading: false,\n      profileFound: !!profile,\n    });\n    if (!profile) {\n      return;\n    }\n    this.setState({\n      keyLoading: true,\n    })\n    this.fetchKey(profile.accountId).then((theirPublicKey64) => {\n      this.setState({\n        keyLoading: false,\n        theirPublicKey64,\n      })\n    });\n  }\n\n  handleChange(key, value) {\n    const stateChange = {\n      [key]: value,\n    };\n    if (key === 'receiverId') {\n      value = value.toLowerCase().replace(/[^a-z0-9\\-_.]/, '');\n      stateChange[key] = value;\n      stateChange.profileLoading = true;\n      stateChange.theirPublicKey64 = false;\n    }\n    this.setState(stateChange);\n  }\n\n  async fetchMessages() {\n    if (!this.props.app) {\n      return;\n    }\n    if (this.fetchTimeoutId) {\n      clearTimeout(this.fetchTimeoutId);\n      this.fetchTimeoutId = null;\n    }\n    console.log(\"Fetching messages\");\n    const message = await this.props.app.pullMessage();\n    if (!message) {\n      this.fetchTimeoutId = setTimeout(() => { this.fetchMessages() }, 60 * 1000);\n      return;\n    }\n    try {\n      console.log(message);\n      let inner = JSON.parse(message.message);\n      const isEncrypted = inner.type === 'encrypted';\n      const fromAppId = inner.fromAppId || this.props.app.appId;\n      if (isEncrypted) {\n        const decryptedMessage = await this.props.app.decryptMessage(inner.content, {\n          accountId: message.sender,\n          appId: inner.fromAppId,\n        });\n        inner = JSON.parse(decryptedMessage);\n      }\n      if (inner.type === 'mail') {\n        const letter = {\n          messageId: this.state.numLetters,\n          isEncrypted,\n          fromAppId,\n          sender: message.sender,\n          subject: inner.subject,\n          content: inner.content,\n          time: Math.trunc(message.time / 1000000),\n        }\n        const newNumLetters = this.state.numLetters + 1;\n        this.setState({\n          numLetters: newNumLetters,\n        });\n\n        this.props.app.set(\"letter_\" + letter.messageId, letter, {encrypted: true}).then(() => {\n          console.log(\"Saved the letter: \", letter);\n        });\n        this.props.app.set(\"numLetters\", newNumLetters, {encrypted: true}).then(() => {\n            console.log(\"Saved the new number of letters: \", newNumLetters);\n        });\n        this.modifyLetter(letter);\n      } else {\n        console.warn(\"Unknown message\", message);\n      }\n    } catch (e) {\n      console.error(e);\n    } finally {\n      this.fetchMessages()\n    }\n  }\n\n  async sendMail() {\n    if (!this.state.profileFound) {\n      return;\n    }\n    console.log(\"Sending mail\");\n    this.setState({\n      sending: true,\n    });\n    try {\n      let message = JSON.stringify({\n        type: \"mail\",\n        subject: this.state.subject,\n        content: this.state.content,\n      });\n      if (this.state.theirPublicKey64) {\n        const content = await this.props.app.encryptMessage(message, {\n          theirPublicKey64: this.state.theirPublicKey64,\n        });\n        message = JSON.stringify({\n          type: \"encrypted\",\n          fromAppId: this.props.app.appId,\n          content,\n        })\n      }\n      await this.props.app.sendMessage(this.state.receiverId, message);\n      this.setState({\n        subject: \"\",\n        content: \"\",\n      })\n    } catch (e) {\n      console.log(\"Failed to send the message\", e);\n    } finally {\n      this.setState({\n        sending: false,\n      });\n      this.fetchMessages();\n    };\n  }\n\n  receiverClass() {\n    if (!this.state.receiverId || this.state.profileLoading) {\n      return \"form-control\";\n    } else if (this.state.profileFound) {\n      return \"form-control is-valid\";\n    } else {\n      return \"form-control is-invalid\";\n    }\n  }\n\n  replyTo(letter, displayName) {\n    this.handleChange(\"receiverId\", letter.sender);\n    this.setState({\n      subject: (letter.subject.startsWith(RE) ? \"\" : RE) + letter.subject,\n      content: [\n        \"\",\n        \"\",\n        [\"On\", new Date(letter.time).toLocaleDateString(), displayName, \"@\" + letter.sender, \"wrote:\"].join(' '),\n        ...letter.content.split(/\\r?\\n/).map(s => \"| \" + s)\n      ].join(\"\\n\"),\n    }, () => {\n      this.textarea.current.focus();\n      this.textarea.current.setSelectionRange(0, 0);\n      this.textarea.current.scrollLeft = 0;\n      this.textarea.current.scrollTop = 0;\n    });\n  }\n\n  selectLetter(letter) {\n    this.setState({\n      expandedId: (this.state.expandedId === letter.messageId) ? -1 : letter.messageId,\n    });\n    if (!letter.read) {\n      letter = JSON.parse(JSON.stringify(letter));\n      letter.read = true;\n      this.props.app.set(\"letter_\" + letter.messageId, letter, {encrypted: true}).then(() => {\n        console.log(\"Saved the letter: \", letter);\n      });\n      this.modifyLetter(letter);\n    }\n  }\n\n  deleteLetter(letter) {\n    this.props.app.remove(\"letter_\" + letter.messageId).then(() => {\n      console.log(\"Deleted the letter: \", letter);\n    });\n    this.modifyLetter(null, letter.messageId);\n  }\n\n  render() {\n    const encryptionEnabled = this.state.theirPublicKey64;\n    const displayEncryptionIcon = this.state.profileFound && !this.state.keyLoading;\n    const encryptionAlt = encryptionEnabled ? \"Encryption is ON\" : \"Not secure! Encryption is OFF\";\n    const encryptionIcon = displayEncryptionIcon &&\n      <img className=\"encryption-icon\" src={encryptionEnabled ? encryptionOn : encryptionOff}\n          title={encryptionAlt} alt={encryptionAlt}/>;\n    const profile = <Profile accountId={this.state.receiverId} onFetch={(profile) => this.updateKey(profile)} defaultProfileUrl={anon}/>;\n    const inbox = this.state.inbox.map((letter, i) => (\n      <Letter\n        key={letter.messageId}\n        letter={letter}\n        expanded={letter.messageId === this.state.expandedId}\n        deleteLetter={(letter) => this.deleteLetter(letter)}\n        replyTo={(letter, displayName) => this.replyTo(letter, displayName)}\n        selectLetter={(letter) => this.selectLetter(letter)} />\n    ));\n    return (\n      <div>\n        Inbox <button className=\"btn btn-sm\" onClick={() => this.fetchMessages()}><span role=\"img\" aria-label=\"Refresh\">🔄</span></button>\n        <div>\n          {inbox}\n        </div>\n        <h3>Send</h3>\n        <div className=\"form-row\">\n          <div className=\"col\">\n            <div className=\"form-group\">\n              <label className=\"sr-only\" htmlFor=\"toAccountId\">To Account ID</label>\n              <div className=\"input-group\">\n                <div className=\"input-group-prepend\">\n                  <div className=\"input-group-text\">@</div>\n                </div>\n                <input type=\"text\" className={this.receiverClass()} id=\"toAccountId\" placeholder=\"To Account ID\" value={this.state.receiverId} disabled={!this.props.app} onChange={(e) => this.handleChange('receiverId', e.target.value)} />\n              </div>\n            </div>\n          </div>\n          {profile}\n        </div>\n        <div className=\"form-group\">\n          <label className=\"sr-only\" htmlFor=\"subject\">Subject</label>\n          <input type=\"text\" className=\"form-control\" id=\"subject\" placeholder=\"Subject\" disabled={!this.props.app} value={this.state.subject} onChange={(e) => this.handleChange('subject', e.target.value)} />\n        </div>\n        <div className=\"form-group\">\n          <textarea ref={this.textarea} id=\"content\" className=\"form-control\" rows=\"7\" disabled={!this.props.app} value={this.state.content} onChange={(e) => this.handleChange('content', e.target.value)} />\n        </div>\n        <div className=\"form-group\">\n          <button className={\"form-control form-control-lg btn \" + (displayEncryptionIcon && !encryptionEnabled ? \"btn-danger\" : \"btn-primary\")} disabled={!this.state.profileFound || this.state.sending} onClick={() => this.sendMail()}>\n            Send {encryptionIcon}</button>\n        </div>\n      </div>\n    )\n  }\n}\n\nexport class Letter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      profile: {\n        profileUrl: null,\n        displayName: '@' + props.letter.sender,\n      },\n    };\n  }\n\n  onClick() {\n    this.props.selectLetter(this.props.letter);\n  }\n\n  render() {\n    const profile = (\n      <div className=\"col-sm-6 col-md-4 col-lg-4 letter-profile\">\n        <Profile accountId={this.props.letter.sender} onFetch={(profile) => profile && this.setState({displayName: profile.displayName})} defaultProfileUrl={anon}/>\n      </div>\n    );\n    const subject = (\n      <div className=\"col-sm-4 col-md\">\n        <div className=\"letter-subject\">{this.props.letter.subject}</div>\n      </div>\n    );\n    const time = this.props.expanded ? (\n      <div className=\"col-sm-2 col-lg-2\">\n        <div className=\"letter-time\">{longTimeFormat(this.props.letter.time)}</div>\n      </div>\n    ) : (\n      <div className=\"col-sm-2 col-lg-1 d-none d-md-block\">\n        <div className=\"letter-time\">{timeFormat(this.props.letter.time)}</div>\n      </div>\n    );\n    if (this.props.expanded) {\n      return (\n        <div className=\"letter letter-expanded\">\n          <div className=\"row letter-expanded-header\" onClick={() => this.onClick()}>\n            {profile}\n            {subject}\n            {time}\n          </div>\n          <div className=\"letter-content-expanded\">\n            <pre>{this.props.letter.content}</pre>\n            <div className=\"row\">\n              <div className=\"col-sm\">\n                <button className=\"btn btn-primary\" onClick={() => this.props.replyTo(this.props.letter, this.state.displayName)}>Reply</button>\n              </div>\n              <div className=\"col-sm\">\n                <button className=\"btn btn-danger float-right\" onClick={() => this.props.deleteLetter(this.props.letter)}>DELETE THIS!</button>\n              </div>\n            </div>\n          </div>\n        </div>\n      );\n    } else {\n      return (\n        <div className={\"row letter letter-small\" + (this.props.letter.read ? \" letter-read\" : \" letter-unread\")} onClick={() => this.onClick()}>\n          {profile}\n          {subject}\n          <div className=\"col-sm d-none d-lg-block\">\n            <div className=\"letter-content\">{this.props.letter.content}</div>\n          </div>\n          {time}\n        </div>\n      );\n    }\n  }\n}\n\nfunction longTimeFormat(t) {\n  return new Date(t).toLocaleString();\n}\n\nfunction timeFormat(t) {\n  const d = new Date(t);\n  const now = new Date();\n  if (now.getDate() === d.getDate()) {\n    const hour = d.getHours() % 12;\n    const minute = d.getMinutes().toString().padStart(2, '0');\n    const daytime = d.getHours() >= 12 ? \"PM\" : \"AM\";\n    return `${hour}:${minute} ${daytime}`;\n  } else {\n    return d.toLocaleDateString();\n  }\n}\n","import React, { Component } from 'react';\nimport nearlogo from './assets/gray_near_logo.svg';\nimport './css/App.css';\nimport * as nearlib from \"nearlib\";\nimport { OpenWebApp } from 'near-openweb-js';\nimport { ProfileApp } from \"./apps/ProfileApp\";\nimport { MailApp } from \"./apps/MailApp\";\nimport { Tab, Tabs, TabList, TabPanel } from 'react-tabs';\nimport 'react-tabs/style/react-tabs.css';\n\nconst GAS = 2_000_000_000_000_000;\nconst TITLE = \"Open Web Home - NEAR\"\n\nexport class Home extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      login: false,\n      apps: {},\n      logs: [],\n      unread: 0,\n      loading: false,\n    }\n    this.signedInFlow = this.signedInFlow.bind(this);\n    this.requestSignIn = this.requestSignIn.bind(this);\n    this.requestSignOut = this.requestSignOut.bind(this);\n    this.signedOutFlow = this.signedOutFlow.bind(this);\n    this.checkSignIn = this.checkSignIn.bind(this);\n    this.initOpenWebApp = this.initOpenWebApp.bind(this);\n    window.nearlib = nearlib;\n  }\n\n  componentDidMount() {\n    this.checkSignIn();\n  }\n\n  async checkSignIn() {\n    let loggedIn = window.walletAccount.isSignedIn();\n    if (loggedIn) {\n      await this.signedInFlow();\n    } else {\n      this.signedOutFlow();\n    }\n  }\n\n  log(message) {\n    console.log(message);\n    this.setState({\n      logs: this.state.logs.concat([message])\n    })\n  }\n\n  async signedInFlow() {\n    const accountId = await this.props.wallet.getAccountId()\n    this.setState({\n      login: true,\n      loading: true,\n      accountId,\n    })\n    if (window.location.search.includes(\"account_id\")) {\n      window.location.replace(window.location.origin + window.location.pathname)\n    }\n    if (window.location.search.includes(\"all_keys\")) {\n      window.location.replace(window.location.origin + window.location.pathname)\n    }\n    // Initializing our contract APIs by contract name and configuration.\n\n    this.log(\"Connecting to account...\");\n    const account = await new nearlib.Account(window.near.connection, accountId);\n    this.log(\"Querying state...\");\n    let state = await account.state();\n    /*\n    await new Promise((resolve, reject) =>{\n      setTimeout(() => {\n        resolve();\n      }, 5000);\n    })\n     */\n    console.log(state);\n    if (state.code_hash !== 'C8UmYSqATkuyhheJ7i7ryxPjfZL4nV8PfkovdMKitsmJ') {\n      this.log(\"Going to deploy the code\");\n      // no code. Need to deploy.\n      this.log(\"Downloading started...\");\n      let data = await fetch('/open_web.wasm');\n      let buf = await data.arrayBuffer();\n      this.log(\"Downloading done. Deploying contract...\");\n      await account.deployContract(new Uint8Array(buf));\n      if (state.code_hash === '11111111111111111111111111111111') {\n        this.log(\"Deploying done. Initializing contract...\");\n        // Gotta init it.\n        let contract = await new nearlib.Contract(account, accountId, {\n          viewMethods: [],\n          // Change methods can modify the state. But you don't receive the returned value when called.\n          changeMethods: ['new'],\n          // Sender is the account ID to initialize transactions.\n          sender: accountId\n        });\n        console.log(await contract.new());\n      }\n      this.log(\"The contract is deployed\");\n    }\n\n    const masterContract = await new nearlib.Contract(account, accountId, {\n      // View methods are read only. They don't modify the state, but usually return some value.\n      viewMethods: ['apps'],\n      // Change methods can modify the state. But you don't receive the returned value when called.\n      changeMethods: ['add_app_key', 'remove_app_key'],\n      // Sender is the account ID to initialize transactions.\n      sender: accountId\n    });\n\n    this.masterContract = masterContract;\n    window.masterContract = masterContract;\n    this.log(\"Fetching authorized apps...\");\n    console.log(\"Apps:\", await masterContract.apps());\n\n    // this.initOpenWebApp = this.initOpenWebApp.bind(this);\n\n    this.log(\"Initializing local apps...\");\n    const apps = {\n      profile: await this.initOpenWebApp('profile', accountId),\n      graph: await this.initOpenWebApp('graph', accountId),\n      mail: await this.initOpenWebApp('mail', accountId)\n    };\n    window.apps = apps;\n    this.apps = apps;\n    this.setState({\n      apps,\n      loading: false,\n    })\n  }\n\n  async initOpenWebApp(appId, accountId) {\n    this.log(\"Initializing app: \" + appId + \" ...\");\n    const app = new OpenWebApp(appId, accountId, window.nearConfig);\n    await app.init();\n    if (!await app.ready()) {\n      let pk = await app.getAccessPublicKey();\n      this.log(\"Authorizing app for key \" + pk.toString() + \" ...\");\n      const args = {\n        public_key: [...nearlib.utils.serialize.serialize(nearlib.transactions.SCHEMA, pk)],\n        app_id: appId,\n      };\n      await this.masterContract.add_app_key(args, GAS);\n      await app.onKeyAdded();\n    }\n    return app;\n  }\n\n  async requestSignIn() {\n    const appTitle = 'Open Web Home';\n    await this.props.wallet.requestSignIn(\n      \"\",\n      appTitle\n    )\n  }\n\n  requestSignOut = () => {\n    this.props.wallet.signOut();\n    setTimeout(this.signedOutFlow, 500);\n    console.log(\"after sign out\", this.props.wallet.isSignedIn())\n  }\n\n\n  signedOutFlow = () => {\n    if (window.location.search.includes(\"account_id\")) {\n      window.location.replace(window.location.origin + window.location.pathname)\n    }\n    this.setState({\n      login: false,\n    })\n  }\n\n  render() {\n    document.title = (this.state.unread ? `(${this.state.unread}) ` : \"\") + TITLE;\n    if (!this.state.login) {\n      return <div className=\"App-header\">\n        <div>\n          <div className=\"image-wrapper\">\n            <img className=\"logo\" src={nearlogo} alt=\"NEAR logo\"/>\n          </div>\n          <h1>Hello ?</h1>\n          <div>\n            <button onClick={this.requestSignIn}>Log in with NEAR</button>\n          </div>\n        </div>\n      </div>\n    } else {\n      return <div>\n        {this.state.loading && (\n          <div className=\"loading-div\">\n            <div className=\"spinner-grow loading-spinner\" role=\"status\">\n              <span className=\"sr-only\">Loading...</span>\n            </div>\n            <pre className=\"text-left\">\n            {this.state.logs.join(\"\\n\")}\n          </pre>\n          </div>\n        )}\n        <div className={\"apps\" + (this.state.loading ? \" d-none\" : \"\")}>\n          <Tabs forceRenderTabPanel={true}>\n            <TabList>\n              <Tab>Profile</Tab>\n              <Tab>Mail {this.state.unread ? `(${this.state.unread})` : \"\"}</Tab>\n            </TabList>\n\n            <TabPanel>\n              <ProfileApp app={this.state.apps.profile} logOut={this.requestSignOut}/>\n            </TabPanel>\n            <TabPanel>\n              <MailApp app={this.state.apps.mail} onNewMail={(unread) => this.setState({unread})}/>\n            </TabPanel>\n          </Tabs>\n        </div>\n      </div>\n    }\n  }\n}\n","import React from \"react\";\nimport queryString from 'query-string';\n\nexport class Auth extends React.Component {\n  constructor(props) {\n    super(props);\n    const values = queryString.parse(this.props.location.search);\n    let {app_id, pub_key} = values;\n    if (app_id && pub_key) {\n      this.state = {\n        authorized:false,\n        new_app_id:app_id,\n        new_pub_key:pub_key\n      };\n    } else {\n      this.state = {\n        authorized:false,\n        new_app_id:\"\",\n        new_pub_key:\"\"\n      }\n    }\n  }\n\n componentDidMount() {\n    if (!this.props.loading && this.state.new_app_id && this.state.new_pub_key) {\n      this.props.initOpenWebApp(this.state.new_app_id, this.state.new_pub_key)\n        .then(res => {\n          this.setState({\n            authorized: true\n          })\n        });\n    }\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.props.app && !this.state.initialized) {\n      // this.init();\n    }\n  }\n  \n  // async fetchProfile(accountId) {\n  //   if (accountId in this.profileCache) {\n  //     return this.profileCache[accountId];\n  //   } else {\n  //     console.log(\"Fetching profile for \" + accountId);\n  //     try {\n  //       const values = await Promise.all([\n  //         this.props.app.getFrom(accountId, 'displayName', 'profile'),\n  //         this.props.app.getFrom(accountId, 'profileUrl', 'profile'),\n  //       ]);\n  //       this.profileCache[accountId] = {\n  //         displayName: values[0] || \"\",\n  //         profileUrl: values[1],\n  //       };\n  //     } catch (e) {\n  //       this.profileCache[accountId] = false;\n  //     }\n  //     return this.profileCache[accountId];\n  //   }\n  // }\n\n  // async registerNewApp(accountId) {\n  //   if (accountId in this.profileCache) {\n  //     return this.profileCache[accountId];\n  //   } else {\n  //     console.log(\"Fetching profile for \" + accountId);\n  //     try {\n  //       const values = await Promise.all([\n  //         this.props.app.getFrom(accountId, 'displayName', 'profile'),\n  //         this.props.app.getFrom(accountId, 'profileUrl', 'profile'),\n  //       ]);\n  //       this.profileCache[accountId] = {\n  //         displayName: values[0] || \"\",\n  //         profileUrl: values[1],\n  //       };\n  //     } catch (e) {\n  //       this.profileCache[accountId] = false;\n  //     }\n  //     return this.profileCache[accountId];\n  //   }\n  // }\n\n  render() {\n    return (\n      <div>\n        {this.state.authorized ? \n        <div>\n          <p>App <strong>{this.state.new_app_id}</strong> was added</p>\n          <p> Using the public key: {this.state.new_pub_key} </p>\n        </div> :\n        \"You need pass a key in order to add an app\"\n        }\n      </div>\n    )\n  }\n}\n","import React, { Component } from 'react';\nimport {HashRouter, Route, Switch} from \"react-router-dom\";\nimport { Home } from './Home';\nimport { Auth } from './Auth';\n\nclass Router extends Component {\n  render() {\n    return (\n      <HashRouter basename={process.env.PUBLIC_URL} hashType=\"noslash\">\n        <Switch>\n          <Route exact path=\"/\" component={() => <Home {...this.props}/>} />\n          <Route path=\"/auth\" component={() => <Auth {...this.props}/>} />\n        </Switch>\n      </HashRouter>\n    );\n  }\n}\n\nexport default Router;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport Router from './Router';\nimport getConfig from './near/config.js';\nimport * as nearlib from 'nearlib';\n\n// Initializing contract\nasync function InitContract() {\n    window.nearConfig = getConfig('development')\n\n    // Initializing connection to the NEAR DevNet.\n    window.near = await nearlib.connect(Object.assign({ deps: { keyStore: new nearlib.keyStores.BrowserLocalStorageKeyStore() } }, window.nearConfig));\n    \n    // Needed to access wallet login\n    window.walletAccount = new nearlib.WalletAccount(window.near);\n    \n    // Getting the Account ID. If unauthorized yet, it's just empty string.\n    window.accountId = window.walletAccount.getAccountId();\n\n}\n\nwindow.nearInitPromise = InitContract().then(() => {\n    ReactDOM.render(<Router contract={window.contract} wallet={window.walletAccount}/>,\n      document.getElementById('root')\n    );\n  }).catch(console.error)","module.exports = __webpack_public_path__ + \"static/media/anon.5cbbd243.png\";","module.exports = __webpack_public_path__ + \"static/media/gray_near_logo.55517b93.svg\";","module.exports = __webpack_public_path__ + \"static/media/encryptionOn.23e3b306.png\";","module.exports = __webpack_public_path__ + \"static/media/encryptionOff.475ce496.png\";","(function() {\n    const CONTRACT_NAME = 'react-template'; /* TODO: fill this in!*/\n    const DEFAULT_ENV = 'development'; \n    \n    function getConfig(env) {\n        switch (env) {\n\n        case 'production':\n        case 'development':\n            return {\n                networkId: 'default',\n                nodeUrl: 'https://rpc.nearprotocol.com',\n                contractName: CONTRACT_NAME,\n                walletUrl: 'https://wallet.nearprotocol.com',\n            };\n        case 'staging':\n            return {\n                networkId: 'staging',\n                nodeUrl: 'https://staging-rpc.nearprotocol.com/',\n                contractName: CONTRACT_NAME,\n                walletUrl: 'https://near-wallet-staging.onrender.com',\n            };\n        case 'local':\n            return {\n                networkId: 'local',\n                nodeUrl: 'http://localhost:3030',\n                keyPath: `${process.env.HOME}/.near/validator_key.json`,\n                walletUrl: 'http://localhost:4000/wallet',\n                contractName: CONTRACT_NAME,\n            };\n        case 'test':\n            return {\n                networkId: 'local',\n                nodeUrl: 'http://localhost:3030',\n                contractName: CONTRACT_NAME,\n                masterAccount: 'test.near',\n            };\n        case 'test-remote':\n        case 'ci':\n            return {\n                networkId: 'shared-test',\n                nodeUrl: 'http://shared-test.nearprotocol.com:3030',\n                contractName: CONTRACT_NAME,\n                masterAccount: 'test.near',\n            };\n        case 'ci-staging':\n            return {\n                networkId: 'shared-test-staging',\n                nodeUrl: 'http://staging-shared-test.nearprotocol.com:3030',\n                contractName: CONTRACT_NAME,\n                masterAccount: 'test.near',\n            };\n        default:\n            throw Error(`Unconfigured environment '${env}'. Can be configured in src/config.js.`);\n        }\n    }\n    \n    let Cookies = require('js-cookie');\n    const cookieConfig = typeof Cookies != 'undefined' && Cookies.getJSON('fiddleConfig');\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = getConfig;\n    } else {\n        window.nearConfig =  cookieConfig && cookieConfig.nearPages ? cookieConfig : getConfig(DEFAULT_ENV);\n    }\n})();\n"],"sourceRoot":""}